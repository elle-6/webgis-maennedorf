<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGIS Männedorf</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    
    <!-- Font Awesome für Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <!-- Unser modernes CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Karte (immer im Hintergrund) -->
    <div id="map"></div>
    
    <!-- Login-Box (wird nach Login ausgeblendet) -->
    <div id="loginBox">
        <div class="login-header">
            <div class="login-logo">
                <i class="fas fa-map-marked-alt"></i>
            </div>
            <h2>WebGIS Männedorf</h2>
            <p>Willkommen im Geoportal</p>
        </div>
        
        <div class="form-group">
            <label class="form-label">Benutzername</label>
            <input type="text" id="username" placeholder="admin" value="admin">
        </div>
        
        <div class="form-group">
            <label class="form-label">Passwort</label>
            <input type="password" id="password" placeholder="••••••••" value="admin123">
        </div>
        
        <button class="btn-primary" onclick="login()">
            <i class="fas fa-sign-in-alt"></i>
            Anmelden
        </button>
        
        <div id="loginStatus"></div>
    </div>
    
    <!-- Top-Bar (erscheint nach Login) -->
    <div class="top-bar hidden" id="topBar">
        <div class="top-bar-left">
            <div class="app-logo">
                <i class="fas fa-map-marked-alt"></i>
            </div>
            <div class="app-title">
                <h1>WebGIS Männedorf</h1>
                <p>Geographisches Informationssystem</p>
            </div>
        </div>
        
        <div class="user-section">
            <div class="user-info">
                <div class="user-name" id="displayUserName">Benutzer</div>
                <div class="user-role" id="displayUserRole">viewer</div>
            </div>
            <div class="user-avatar" id="displayUserAvatar">U</div>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                Abmelden
            </button>
        </div>
    </div>
    
    <!-- Sidebar (erscheint nach Login) -->
    <div class="sidebar hidden" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">
                <i class="fas fa-layer-group"></i>
                Kartenverwaltung
            </div>
            <button class="sidebar-collapse" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left"></i>
            </button>
        </div>
        
        <!-- Tabs -->
        <div class="sidebar-tabs">
            <button class="tab-btn active" onclick="switchTab('layers')">
                <i class="fas fa-layer-group"></i> Layer
            </button>
            <button class="tab-btn" onclick="switchTab('features')">
                <i class="fas fa-list"></i> Features
            </button>
            <button class="tab-btn" onclick="switchTab('filter')">
                <i class="fas fa-filter"></i> Filter
            </button>
        </div>
        
        <!-- Sidebar-Content -->
        <div class="sidebar-content">
            <!-- Layer-Tab -->
            <div class="tab-content active" id="layersTab">
                <h3 style="margin-bottom: 15px; color: #1a1a2e;">Kartenebenen</h3>
                <div id="layersList">
                    <!-- Beispiel-Layer (werden später dynamisch) -->
                    <div class="layer-item">
                        <div class="layer-info">
                            <div class="layer-name">Alle Features</div>
                            <div class="layer-desc">Alle gespeicherten Punkte</div>
                        </div>
                        <div class="toggle-switch active" onclick="toggleLayer(this)"></div>
                    </div>
                </div>
            </div>
            
            <!-- Features-Tab -->
            <div class="tab-content" id="featuresTab">
                <h3 style="margin-bottom: 15px; color: #1a1a2e;">Alle Features</h3>
                <div class="form-group">
                    <input type="text" id="featureSearch" placeholder="Features durchsuchen...">
                </div>
                <div id="featuresList">
                    <p style="text-align: center; color: #666; padding: 20px;">
                        Keine Features geladen
                    </p>
                </div>
            </div>
            
            <!-- Filter-Tab -->
            <div class="tab-content" id="filterTab">
                <h3 style="margin-bottom: 15px; color: #1a1a2e;">Features filtern</h3>
                <div class="form-group">
                    <label class="form-label">Feature-Typ</label>
                    <select id="filterType">
                        <option value="">Alle Typen</option>
                        <option value="poi">POI</option>
                        <option value="building">Gebäude</option>
                        <option value="road">Straße</option>
                        <option value="park">Park</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Name enthält</label>
                    <input type="text" id="filterName" placeholder="z.B. Rathaus">
                </div>
                
                <button class="btn-primary" onclick="applyFilters()">
                    <i class="fas fa-search"></i>
                    Filter anwenden
                </button>
                
                <button class="btn-secondary" onclick="resetFilters()">
                    <i class="fas fa-times"></i>
                    Zurücksetzen
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toolbar (erscheint nach Login) -->
    <div class="toolbar hidden" id="toolbar">
        <button class="toolbar-btn" onclick="addMarker()" title="Punkt hinzufügen">
            <i class="fas fa-map-marker-alt"></i>
        </button>
        
        <div class="toolbar-divider"></div>
        
        <button class="toolbar-btn" onclick="loadFeatures()" title="Features laden">
            <i class="fas fa-sync-alt"></i>
        </button>
        
        <button class="toolbar-btn" onclick="map.zoomIn()" title="Hineinzoomen">
            <i class="fas fa-plus"></i>
        </button>
        
        <button class="toolbar-btn" onclick="map.zoomOut()" title="Herauszoomen">
            <i class="fas fa-minus"></i>
        </button>
        
        <div class="toolbar-divider"></div>
        
        <button class="toolbar-btn" onclick="showMyLocation()" title="Mein Standort">
            <i class="fas fa-location-arrow"></i>
        </button>
    </div>
    
    <!-- Status-Bereich -->
    <div id="status"></div>
    
    <!-- Loading-Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>
    
    <!-- Leaflet JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    
    <!-- Unser JavaScript (gleiche Logik wie vorher, nur UI-Anpassungen) -->
    <script src="js/app.js"></script>
</body>
</html>
